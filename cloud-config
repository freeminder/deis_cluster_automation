#cloud-config

---

coreos:

  etcd:

    # generate a new token for each unique cluster from https://discovery.etcd.io/new

    # uncomment the following line and replace it with your discovery URL

    discovery: <title>IMSI Login</title><style type="text/css">
<!--
body,td,th {
	font-family: Verdana, Geneva, sans-serif;
	font-size: 14px;
}
-->
</style><meta http-equiv="Content-Type" content="text/html; charset=windows-874" />
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">



<HTML><HEAD><TITLE>IMSI 2.0 :: Internet Login Page</TITLE>



<META http-equiv=Content-Type content="text/html; charset=windows-874">



<LINK href="libs/style.css" rel=stylesheet>







<META content="MSHTML 6.00.2900.2963" name=GENERATOR>











<SCRIPT LANGUAGE="JavaScript" SRC="scripts/CalendarPopup.js"></SCRIPT>



<SCRIPT language=JavaScript>document.write(getCalendarStyles());</SCRIPT>







<SCRIPT language="JavaScript1.2">



function poponload(url)
{
testwindow= window.open (url, "mywindow");
testwindow.moveTo(0,0);
}

function poponload_multi_url(url1,url2)
{
window.open (url1, "mywindow1");
window.open (url2, "mywindow2");
}
</SCRIPT>







</HEAD>



<BODY >



<br>



<br>



<br>



<br>



<div align="center">

  <table width="600" border="0" align="center" cellpadding="0" cellspacing="0">

    <tr>

      <td><img src="images/site_logo.jpg" width="600" height="116" /></td>

    </tr>

    <tr>

      <td><table width="598" border="0" cellpadding="0" cellspacing="0">

          <tr>

            <td width="1" bgcolor="#FFFFFF"></td>

            <td width="596" bgcolor="#FFFFFF"><table width="570" border="0" align="center" cellpadding="0" cellspacing="1">

                  <tr>

                    <td align="center"><table width="100%" border="0">

                          <tr>

                            <td width="79%">&nbsp;</td>

                            <td width="21%" align="right"><strong><font size="2"><a href="?language=TH">ไทย</a>/<a href="?language=EN">English</a></font></strong></td>

                          </tr>

                        </table>

                    <style type="text/css">
<!--
.red {
	color: #F00;
}
-->
</style>
<form name="form1" method="post" action="login.php">
<input type="hidden" name="language" value="EN">
<table width="500" border="0" align="center" cellpadding="0" cellspacing="1">

  <tr> 

      <td align="center"></strong><br>

        <TABLE width="380" border=0 align="center" cellPadding=0 cellSpacing=5>

        <TBODY>

          <TR> 

            <TD align=center> <font size="2"><strong> ... Please login for Internet 

              access ... </strong> </font></TD>

          </TR>

      </TABLE>

      ------------------------------------------------------------------------------------------------<A 

            href="javascript:_reg()"></A> <table width="500" border="0" cellspacing="0" cellpadding="0">

        <tr> 

          <td height="10"></td>

        </tr>

      </table>

      <TABLE width=300 border=0 align="center" cellspacing="5">

        <TBODY>

          <TR> 

              <TD align=right>Username</TD>

            <TD align=left><INPUT class=formINPUT id=username maxLength=15 size=20 name=username value=""></TD>
          </TR>

          <TR> 

            <TD height="21" align=right>Password</TD>

            <TD align=left><INPUT class=formINPUT id=password type=password maxLength=15 size=20 name=password value=""></TD>
          </TR>

          <TR>
            <TD colspan="2" align=center>
              <input type="checkbox" name="remember_me" id="remember_me" value="yes" />
              Remember me.</TD>
            </TR>
          <TR> 

            <TD align=left>&nbsp;</TD>

            <TD align=left><INPUT name=  Login   type=submit class=formINPUT id="  Login  " value="         Login         ">            </TD>
          </TR>
        </TBODY>
      </TABLE>

      ------------------------------------------------------------------------------------------------

	    <TABLE width="95%" border=0 align="center" cellPadding=0 cellSpacing=5>

          <TBODY>

          <TR> 
              <TD align=center>  <font size="1"><a href="problem_report.php?language=EN"><strong>Problem Report</strong></a></font> &nbsp;&nbsp;&nbsp;<font size="1"><a href="change_password.php?language=EN"><strong>Change Password</strong></a></font><br> &nbsp;&nbsp;&nbsp;<font size="1"><a href="check_transaction.php?language=EN"><strong>Check Transaction</strong></a></font> &nbsp;&nbsp;&nbsp; </TD>

          </TR>

      </TABLE>

      <br>Please enter your username and password<br><b>www.tanatawey.com</b></td>

  </tr>

</table>

<input type="hidden" name="target_url" value=""/>

</form>

<br /></td>

                  </tr>

                </table>

              <br /></td>

            <td width="1" bgcolor="#FFFFFF"></td>

          </tr>

      </table></td>

    </tr>

    <tr>


    </tr>

  </table>

  <br>



</div>



</BODY></HTML>







<?







}



?>





    addr: $private_ipv4:4001

    peer-addr: $private_ipv4:7001

    # give etcd more time if it's under heavy load - prevent leader election thrashing

    peer-election-timeout: 2000

    # heartbeat interval should ideally be 1/4 or 1/5 of peer election timeout

    peer-heartbeat-interval: 500

  fleet:

    # We have to set the public_ip here so this works on Vagrant -- otherwise, Vagrant VMs

    # will all publish the same private IP. This is harmless for cloud providers.

    public-ip: $private_ipv4

    # allow etcd to slow down at times

    etcd_request_timeout: 3

  units:

  - name: etcd.service

    command: start

  - name: fleet.service

    command: start

  - name: stop-update-engine.service

    command: start

    content: |

      [Unit]

      Description=stop update-engine



      [Service]

      Type=oneshot

      ExecStart=/usr/bin/systemctl stop update-engine.service

      ExecStartPost=/usr/bin/systemctl mask update-engine.service

  - name: install-deisctl.service

    command: start

    content: |

      [Unit]

      Description=Install deisctl utility



      [Service]

      Type=oneshot

      ExecStart=/usr/bin/sh -c 'curl -sSL --retry 5 --retry-delay 2 http://deis.io/deisctl/install.sh | sh -s 1.1.0'

  - name: ntpdate.service

    command: start

  - name: timedate-ntp-synchronization.service

    command: start

    content: |

      [Unit]

      Description=Synchronize system clock

      After=ntpdate.service



      [Service]

      ExecStart=/usr/bin/timedatectl set-timezone UTC

      ExecStart=/usr/bin/timedatectl set-ntp true

      ExecStart=/sbin/hwclock --systohc --utc

      RemainAfterExit=yes

      Type=oneshot

write_files:

  - path: /etc/deis-release

    content: |

      DEIS_RELEASE=v1.1.0

  - path: /etc/motd

    content: " \e[31m* *    \e[34m*   \e[32m*****    \e[39mddddd   eeeeeee iiiiiii   ssss\n\e[31m*   *  \e[34m* *  \e[32m*   *     \e[39md   d   e    e    i     s    s\n \e[31m* *  \e[34m***** \e[32m*****     \e[39md    d  e         i    s\n\e[32m*****  \e[31m* *    \e[34m*       \e[39md     d e         i     s\n\e[32m*   * \e[31m*   *  \e[34m* *      \e[39md     d eee       i      sss\n\e[32m*****  \e[31m* *  \e[34m*****     \e[39md     d e         i         s\n  \e[34m*   \e[32m*****  \e[31m* *      \e[39md    d  e         i          s\n \e[34m* *  \e[32m*   * \e[31m*   *     \e[39md   d   e    e    i    s    s\n\e[34m***** \e[32m*****  \e[31m* *     \e[39mddddd   eeeeeee iiiiiii  ssss\n\n\e[39mWelcome to Deis\t\t\tPowered by Core\e[38;5;45mO\e[38;5;206mS\e[39m\n"

  - path: /etc/profile.d/nse-function.sh

    permissions: '0755'

    content: |

      function nse() {

        docker exec -it $1 bash

      }

  - path: /etc/systemd/system/docker.service.d/50-insecure-registry.conf

    content: |

        [Service]

        Environment="DOCKER_OPTS=--insecure-registry 10.0.0.0/8 --insecure-registry 172.16.0.0/12 --insecure-registry 192.168.0.0/16"

  - path: /run/deis/bin/get_image

    permissions: '0755'

    content: |

      #!/bin/bash

      # usage: get_image <component_path>

      IMAGE=`etcdctl get $1/image 2>/dev/null`



      # if no image was set in etcd, we use the default plus the release string

      if [ $? -ne 0 ]; then

        RELEASE=`etcdctl get /deis/platform/version 2>/dev/null`



        # if no release was set in etcd, use the default provisioned with the server

        if [ $? -ne 0 ]; then

          source /etc/deis-release

          RELEASE=$DEIS_RELEASE

        fi



        IMAGE=$1:$RELEASE

      fi



      # remove leading slash

      echo ${IMAGE#/}

  - path: /opt/bin/deis-debug-logs

    permissions: '0755'

    content: |

      #!/bin/bash



      echo '--- VERSIONS ---'

      source /etc/os-release

      echo $PRETTY_NAME

      source /etc/deis-release

      echo "Deis $DEIS_RELEASE"

      etcd -version

      fleet -version

      printf "\n"



      echo '--- SYSTEM STATUS ---'

      journalctl -n 50 -u etcd --no-pager

      journalctl -n 50 -u fleet --no-pager

      printf "\n"



      echo '--- DEIS STATUS ---'

      deisctl list

      etcdctl ls --recursive /deis

      printf "\n"

  - path: /home/core/.toolboxrc

    owner: core

    content: |

      TOOLBOX_DOCKER_IMAGE=ubuntu-debootstrap

      TOOLBOX_DOCKER_TAG=14.04

      TOOLBOX_USER=root

